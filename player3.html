<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Document</title>  

    <script src="//ssl.p.jwpcdn.com/player/v/8.26.0/jwplayer.js"></script>  
    <meta content="noindex, nofollow, noarchive" name="robots">  
    <script>jwplayer.key = "XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo";</script>  
    <meta name="robots" content="noindex, nofollow" />  
    <meta name="referrer" content="no-referrer" />  
    <style>  
        body {  
            margin: 0;  
            padding: 0;  
        }  
        #player {  
            height: 100vh !important;  
        }  
    </style>  
</head>  
<body>  

    <div id="player"></div>  

    <script type="text/javascript">  
        function getParameterByName(name) {  
            name = name.replace(/[\[\]]/g, "\\$&");  
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),  
                results = regex.exec(window.location.href);  
            if (!results) return null;  
            if (!results[2]) return '';  
            return decodeURIComponent(results[2].replace(/\+/g, " "));  
        }  

        fetch('channels.json')  
            .then(response => response.json())  
            .then(data => {  
                console.log(data);  
                var id = getParameterByName('id');  
                var config = data[id];  

                if (config) {  
                    var sources = [];  
                    if (config.url.includes('.m3u8')) {  
                        sources.push({ file: config.url });  
                    }  

                    if (config.url.includes('.mpd') && config.k1 && config.k2) {  
                        sources.push({  
                            file: config.url,  
                            drm: { "clearkey": { "keyId": config.k1, "key": config.k2 ,"robustness": "SW_SECURE_DECODE" } }  
                        });  
                    }  

                    jwplayer("player").setup({  
                        logo: {  
                            file: 'logo.png',  
                            link: '',  
                            position: 'bottom-left'  
                        },  
                        playlist: [{  
                            image: "",  
                            sources: sources  
                        }],  
                        autostart: false,  
                        width: "100%",  
                        height: "100%",  
                        preload: "auto", // إعداد التحميل المسبق
                        aspectratio: "16:9",  
                        cast: {},  
                        sharing: {}  
                    });
                    // إضافة معالجة الأخطاء هنا
                    jwplayer("player").on('error', function(event) {
                        console.error("Error Code:", event.code, "Message:", event.message);
                    });  
                }  
            })  
            .catch(error => console.error('Error loading channel config:', error));  
    </script>  
</body>  
</html>  
